#coding=utf8
__author__ = 'xujun'

platforms = """
[
    {
        "m_nType": 1,
        "m_strConfig": "",
        "m_nId": 20001,
        "m_strLogo": "broker_logo_1",
        "m_strQuoterTag": "xtquoter",
        "m_strName": "CTP实盘",
        "m_strBrokerTag": "xtbroker",
        "m_strAbbrName": "sqsp",
        "m_strSoName" : "sfit"
    },
    {
        "m_nType": 1,
        "m_strConfig": "",
        "m_nId": 20003,
        "m_strLogo": "broker_logo_1",
        "m_strQuoterTag": "xtquoter",
        "m_strName": "v8t实盘",
        "m_strBrokerTag": "xtbroker",
        "m_strAbbrName": "sqsp",
        "m_strSoName" : ""
    },
    {
        "m_nType": 1,
        "m_strConfig": "sim/option_ctp",
        "m_nId": 21001,
        "m_strLogo": "broker_logo_1",
        "m_strQuoterTag": "xtquoter",
        "m_strName": "CTP模拟",
        "m_strBrokerTag": "xtbroker",
        "m_strAbbrName": "gdmn",
        "m_strSoName" : "sfit"
    },
    {
        "m_nType": 1,
        "m_strConfig": "",
        "m_nId": 21003,
        "m_strLogo": "broker_logo_1",
        "m_strQuoterTag": "xtquoter",
        "m_strName": "v8t模拟",
        "m_strBrokerTag": "xtbroker",
        "m_strAbbrName": "gdmn",
        "m_strSoName" : ""
    },
    {
        "m_nType": 1,
        "m_strConfig": "",
        "m_nId": 21009,
        "m_strLogo": "broker_logo_1",
        "m_strQuoterTag": "xtquoter",
        "m_strName": "迅投模拟",
        "m_strBrokerTag": "xtbroker",
        "m_strAbbrName": "xtmn"
    },
    {
        "m_nType": 2,
        "m_strConfig": "real/kingdom_invs",
        "m_nId": 10001,
        "m_strLogo": "broker_logo_1",
        "m_strQuoterTag": "xtquoter",
        "m_strName": "中投证券",
        "m_strBrokerTag": "xtbroker",
        "m_strAbbrName": "jzsp",
        "m_strSoName" : "kingdom"
    },
    {
        "m_nType": 2,
        "m_strConfig": "sim/kingdom_invs",
        "m_nId": 11001,
        "m_strLogo": "broker_logo_1",
        "m_strQuoterTag": "xtquoter",
        "m_strName": "中投证券模拟",
        "m_strBrokerTag": "xtbroker",
        "m_strAbbrName": "jzmn",
        "m_strSoName" : "kingdom"
    },
    {
        "m_nType": 2,
        "m_strConfig": "",
        "m_nId": 10002,
        "m_strLogo": "broker_logo_1",
        "m_strQuoterTag": "xtquoter",
        "m_strName": "中金证券",
        "m_strBrokerTag": "xtbroker_10002",
        "m_strAbbrName": "hssp",
        "m_strSoName" : ""
    },
    {
        "m_nType": 2,
        "m_strConfig": "",
        "m_nId": 11002,
        "m_strLogo": "broker_logo_1",
        "m_strQuoterTag": "xtquoter",
        "m_strName": "中金证券模拟",
        "m_strBrokerTag": "xtbroker",
        "m_strAbbrName": "hsmn",
        "m_strSoName" : ""
    },
    {
        "m_nType": 2,
        "m_strConfig": "real/sungard_actual",
        "m_nId": 10003,
        "m_strLogo": "broker_logo_1",
        "m_strQuoterTag": "xtquoter",
        "m_strName": "东方证券",
        "m_strBrokerTag": "xtbroker",
        "m_strAbbrName": "jsdsp",
        "m_strSoName" : "sgdstock"
    },
    {
        "m_nType": 2,
        "m_strConfig": "sim/sungard_orient",
        "m_nId": 11003,
        "m_strLogo": "broker_logo_1",
        "m_strQuoterTag": "xtquoter",
        "m_strName": "东方证券模拟",
        "m_strBrokerTag": "xtbroker",
        "m_strAbbrName": "jsdmn",
        "m_strSoName" : "sgdstock"
    },
    {
        "m_nType": 1,
        "m_strConfig": "sim/rzrk_stock",
        "m_nId": 11009,
        "m_strLogo": "broker_logo_1",
        "m_strQuoterTag": "xtquoter",
        "m_strName": "迅投模拟",
        "m_strBrokerTag": "xtbroker",
        "m_strAbbrName": "xtmn",
        "m_strSoName" : "rzrkstock"
    },
    {
        "m_nType": 2,
        "m_strConfig": "real/hundsun_cjstock_actual",
        "m_nId": 10004,
        "m_strLogo": "broker_logo_1",
        "m_strQuoterTag": "xtquoter",
        "m_strName": "长江证券",
        "m_strBrokerTag": "xtbroker_10004",
        "m_strAbbrName": "cjhssp",
        "m_strSoName" : "CJStock"
    },
    {
        "m_nType": 2,
        "m_strConfig": "real/citic_actual",
        "m_nId": 10005,
        "m_strLogo": "broker_logo_1",
        "m_strQuoterTag": "xtquoter",
        "m_strName": "中信证券",
        "m_strBrokerTag": "xtbroker",
        "m_strAbbrName": "zxzq",
        "m_strSoName" : "CiticStock"
    },
    {
        "m_nType": 2,
        "m_strConfig": "sim/citic_test",
        "m_nId": 11005,
        "m_strLogo": "broker_logo_1",
        "m_strQuoterTag": "xtquoter",
        "m_strName": "中信证券模拟",
        "m_strBrokerTag": "xtbroker",
        "m_strAbbrName": "zxzq",
        "m_strSoName" : "CiticStock"
    },
    {
        "m_nType": 2,
        "m_strConfig": "../config/real/qilu_stock",
        "m_nId": 10006,
        "m_strLogo": "broker_logo_1",
        "m_strQuoterTag": "xtquoter",
        "m_strName": "齐鲁证券",
        "m_strBrokerTag": "xtbroker",
        "m_strAbbrName": "qlzq",
        "m_strSoName" : "qilustock"
    },
    {
        "m_nType": 2,
        "m_strConfig": "real/htsc_stock",
        "m_nId": 10007,
        "m_strLogo": "broker_logo_1",
        "m_strQuoterTag": "xtquoter",
        "m_strName": "华泰证券",
        "m_strBrokerTag": "xtbroker",
        "m_strAbbrName": "htzq",
        "m_strSoName" : "htscstock"
    },
    {
        "m_nType": 2,
        "m_strConfig": "real/sywg_stock",
        "m_nId": 10010,
        "m_strLogo": "broker_logo_1",
        "m_strQuoterTag": "xtquoter",
        "m_strName": "申万证券",
        "m_strBrokerTag": "xtbroker",
        "m_strAbbrName": "swzq",
        "m_strSoName" : "sywgstock"
    },
    {
        "m_nType": 2,
        "m_strConfig": "sim/sywg_stock",
        "m_nId": 11010,
        "m_strLogo": "broker_logo_1",
        "m_strQuoterTag": "xtquoter",
        "m_strName": "申万证券模拟",
        "m_strBrokerTag": "xtbroker",
        "m_strAbbrName": "swmn",
        "m_strSoName" : "sywgstock"
    },
    {
        "m_nType": 2,
        "m_strConfig": "real/ydsc_stock",
        "m_nId": 10012,
        "m_strLogo": "broker_logo_1",
        "m_strQuoterTag": "xtquoter",
        "m_strName": "YINGDA_SIM",
        "m_strBrokerTag": "xtbroker",
        "m_strAbbrName": "ydmn",
        "m_strSoName" : "ydscstock"
    },
    {
        "m_nType": 2,
        "m_strConfig": "",
        "m_nId": 10016,
        "m_strLogo": "broker_logo_1",
        "m_strQuoterTag": "xtquoter",
        "m_strName": "海通证券",
        "m_strBrokerTag": "xtbroker",
        "m_strAbbrName": "hait_zq",
        "m_strSoName" : "haitstock"
    },
    {
        "m_nType": 2,
        "m_strConfig": "sim/hait_stock_sim",
        "m_nId": 11016,
        "m_strLogo": "broker_logo_1",
        "m_strQuoterTag": "xtquoter",
        "m_strName": "海通证券模拟",
        "m_strBrokerTag": "xtbroker",
        "m_strAbbrName": "hait_zq_sim",
        "m_strSoName" : "haitstock"
    },
    {
        "m_nType": 2,
        "m_strConfig": "sim/qilu_stock",
        "m_nId": 11006,
        "m_strLogo": "broker_logo_1",
        "m_strQuoterTag": "xtquoter",
        "m_strName": "齐鲁模拟",
        "m_strBrokerTag": "xtbroker",
        "m_strAbbrName": "qlmn",
        "m_strSoName" : "qilustock"
    },
    {
        "m_nType": 2,
        "m_strConfig": "sim/guoxinSecurities_test",
        "m_nId": 11008,
        "m_strLogo": "broker_logo_1",
        "m_strQuoterTag": "xtquoter",
        "m_strName": "国信证券模拟",
        "m_strBrokerTag": "xtbroker_11008",
        "m_strAbbrName": "gxzqmn",
        "m_strSoName" : "guosenstock"
    },
    {
        "m_nType": 2,
        "m_strConfig": "real/guoxinSecurities_test",
        "m_nId": 10008,
        "m_strLogo": "broker_logo_1",
        "m_strQuoterTag": "xtquoter",
        "m_strName": "国信证券",
        "m_strBrokerTag": "xtbroker",
        "m_strAbbrName": "gxzqmn",
        "m_strSoName" : "guosenstock"
    },
    {
        "m_nType": 2,
        "m_strConfig": "real/gzs_stock",
        "m_nId": 10018,
        "m_strLogo": "broker_logo_1",
        "m_strQuoterTag": "xtquoter",
        "m_strName": "银河证券实盘",
        "m_strBrokerTag": "xtbroker",
        "m_strAbbrName": "yhsp",
        "m_strSoName" : "gzsstock"
    },
    {
        "m_nType": 2,
        "m_strConfig": "",
        "m_nId": 11022,
        "m_strLogo": "broker_logo_1",
        "m_strQuoterTag": "xtquoter",
        "m_strName": "广发证券模拟",
        "m_strBrokerTag": "xtbroker_11022",
        "m_strAbbrName": "gfmn",
        "m_strSoName" : ""
    },
    {
        "m_nType": 3,
        "m_strConfig": "real/citic_actual",
        "m_nId": 10005,
        "m_strLogo": "broker_logo_1",
        "m_strQuoterTag": "xtquoter",
        "m_strName": "中信证券",
        "m_strBrokerTag": "xtbroker",
        "m_strAbbrName": "zxzq",
        "m_strSoName" : "CiticStock"
    },
    {
        "m_nType": 3,
        "m_strConfig": "sim/citic_test",
        "m_nId": 11005,
        "m_strLogo": "broker_logo_1",
        "m_strQuoterTag": "xtquoter",
        "m_strName": "中信证券模拟",
        "m_strBrokerTag": "xtbroker",
        "m_strAbbrName": "zxzqmn",
        "m_strSoName" : "CiticStock"
    }
]
"""
import pymongo
from json import loads

def load(db):
    datas = loads(platforms)
    for x in datas:
        x["m_strBrokerTag"] = "xtbroker_%d_%d"%(x["m_nType"], x["m_nId"])
        db.platform.update({"m_nId":x["m_nId"], "m_nType":x["m_nType"]}, {"$set": x}, upsert=True)

def modify(db):
    datas = db.file_info.find()
    for x in datas:
        x["rawPath"] = x["rawPath"].replace("Branch}}", "}}")
        db.file_info.update({"_id":x["_id"]}, {"$set": x}, upsert=True)

if __name__ == "__main__":
    DB_HOST = "192.168.1.187"
    conn = pymongo.Connection(host=DB_HOST)
    db = conn.ttengine
    modify(db)
